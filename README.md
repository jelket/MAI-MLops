# Отслеживание экспериментов с MLflow и Docker Compose

Этот проект демонстрирует настройку сервера MLflow с использованием Docker Compose для отслеживания экспериментов машинного обучения.

## Структура проекта

```
.
├── docker-compose.yml        # Конфигурация Docker Compose
├── train.py                  # Скрипт обучения с интеграцией MLflow
├── mlflow.db                 # SQLite база данных для MLflow (создается при первом запуске)
├── artifacts/                # Директория для хранения артефактов моделей
└── README.md                 # Этот файл
```

## Требования

- Docker
- Docker Compose

## Быстрый старт

### 1. Запуск сервера MLflow и задачи обучения

Выполните следующую команду для запуска сервера MLflow и задачи обучения:

```bash
docker-compose up --build
```

Это выполнит:
1. Запуск сервера MLflow на порту 5000
2. Запуск задачи обучения, которая будет логировать эксперименты на сервер

### 2. Доступ к веб-интерфейсу MLflow

После запуска сервисов вы можете получить доступ к веб-интерфейсу MLflow по адресу:

```
http://localhost:5000
```

В интерфейсе вы увидите:
- Эксперимент "Iris_Classification"
- Запуск с залогированными параметрами и метриками
- Артефакт обученной модели

## Как это работает

### Сервер MLflow

Сервер MLflow настроен с:
- Бэкенд-хранилищем SQLite (`mlflow.db`)
- Локальным хранилищем артефактов (`./artifacts`)
- Доступен по адресу `http://localhost:5000`

### Задача обучения

Задача обучения:
1. Загружает набор данных Iris
2. Обучает RandomForestClassifier
3. Логирует в MLflow:
   - Параметры (n_estimators)
   - Метрики (accuracy)
   - Артефакт модели

## Настройка

### Запуск только сервера MLflow:

```bash
docker-compose up mlflow-server
```

### Запуск только задачи обучения (после запуска сервера):

```bash
docker-compose up training-job
```

## Решение проблем

При возникновении проблем с подключением:
1. Убедитесь, что сервер MLflow запущен
2. Проверьте, что задача обучения использует правильный URI (`http://mlflow-server:5000`)

## Очистка

Для остановки и удаления всех контейнеров:

```bash
docker-compose down
```

Для удаления базы данных и артефактов:

```bash
docker-compose down -v
rm -rf artifacts/ mlflow.db
```

> **Примечание:** Файл `docker-compose.yml` использует образ Python для запуска сервера MLflow для простоты. В продакшене рекомендуется использовать официальный образ MLflow Docker или собрать собственный образ.
